# FPGCN

# Feature Pyramid-based Graph Convolutional Neural network for Graph Classification
The implementation of the paper "[Feature pyramid-based graph convolutional neural network for graph classification](https://www.sciencedirect.com/science/article/pii/S138376212200114X)"

## environment

- [Python 3.6.9](https://www.python.org/)
- [PyTorch 1.4.0](https://pytorch.org/)

- OS: Ubuntu18.04

### torch

- torch==1.4 

### PYG

according to the version of CUDA
replace following ${CUDA} with `cpu`，`cu92`，`cu101`，`cu102` or `cu110`，according to your cuda version

```
pip install torch-scatter -f https://pytorch-geometric.com/whl/torch-1.4.0+cu101.html
pip install torch-sparse -f https://pytorch-geometric.com/whl/torch-1.4.0+cu101.html
pip install torch-cluster -f https://pytorch-geometric.com/whl/torch-1.4.0+cu101.html
pip install torch-spline-conv -f https://pytorch-geometric.com/whl/torch-1.4.0+cu101.html
pip install torch-geometric
```

### other packages

```
pip install -r ./requirements.txt
```

## Project Structure

```
./data
	the datasets are formatted as .pt file generated by PYG
For example：
-DD
  -raw                   the raw DD dataset，https://chrsmrrs.github.io/datasets/
  -processed             Proprietary data pt file for PYG framework generated from raw
  -raw_cleaned			 cleaned dataset of DD，containing only non-isomorphic graphs
  -processed_cleaned     generated from raw_cleaned
```

```
./examples
 comes from https://github.com/rusty1s/pytorch_geometric
 Some well implemented graph neural networks
```

###  Iteration of our Model

```
./GraphFPN
    the different version of our model, the log file record the optimized and improved parts

    you can change the dataset in config.py and then train the model
    
    v7-GraphFPN.py is our complete  model
```

### Performance Comparison

```
./GraphFPN_likepaper
-batch_program.py
	Batch training of our models under different random numbers.
-new-v1-GraphFPN
	Our complete model
	you can change the dataset in config.py
-new-v2-GraphFPN
	different pooling method
```

### Ablation Experiments

```
Ablation based on new-v1-GraphFPN

no atten
Masking Code Lines 127 - 131

no zero
Masking Code Lines 108 - 115
```

### Visualization by T-sne

```
./plotpng
   - plt-v1-GraphFPN : visualization model by T-SNE

```

### Others

```
./result
-extract
 save result
   for example: v1_new_record_log_210308,txt -> graphfpn.csv

./run
 save the model weights

./util
 some tool functions
-MeanunPooling.py: contain the unpooling methods
```

### config

```
config.py
```


### Citation information
If our repo is useful to you, please cite our published paper as follow:
```
Bibtex
@article{lu2022FPGCN,
    title={Feature pyramid-based graph convolutional neural network for graph classification},
    author={Lu, Mingming and Xiao, Zhixiang and Li, Haifeng and Zhang, Ya and Xiong, Neal N.},
    journal={Journal of Systems Architecture},
    DOI = {10.1016/j.sysarc.2022.102562},
    year={2022},
    type = {Journal Article}
}
  
Endnote
%0 Journal Article
%A Lu, Mingming
%A Xiao, Zhixiang
%A Li, Haifeng
%A Zhang, Ya
%A Xiong, Neal N.
%D 2022
%T Feature pyramid-based graph convolutional neural network for graph classification
%B Journal of Systems Architecture
%R 10.1016/j.sysarc.2022.102562
%! Feature pyramid-based graph convolutional neural network for graph classification

```
